<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="view_account_sale_invoice_tree_qm" model="ir.ui.view">
        <field name="name">qm.account.sale.invoice.tree</field>
        <field name="model">account.sale.invoice</field>
        <field name="arch" type="xml">
            <tree string="Invoices" decoration-muted="state=='cancel'" multi_edit="1">
                <field name="name"/>
                <field name="code" optional="show"/>
                <field name="type" optional="show"/>
                <field name="express_code" optional="show"/>
                <field name="sent_type" optional="hide"/>
                <field name="sent_date" optional="show"/>
                <field name="tax_rate" optional="show"/>
                <field name="amount_untaxed" optional="hide"/>
                <field name="amount_tax" optional="hide"/>
                <field name="amount_total" optional="show"/>
                <field name="state" optional="show"/>
            </tree>
        </field>
    </record>


    <record id="view_account_sale_invoice_form_qm" model="ir.ui.view">
        <field name="name">qm.account.sale.invoice.form</field>
        <field name="model">account.sale.invoice</field>
        <field name="arch" type="xml">
            <form string="Invoices">
              <header>
                <button name="post" states="draft" type="object" class="btn-primary" string="Post"/>
                <button name="action_draft" class="btn btn-secondary" attrs="{'invisible': [('state', '=', 'draft')]}" string="Reset To Draft" type="object" groups="account.group_account_invoice"/>
                <button name="action_send" states="posted" string="Send" type="object" groups="account.group_account_invoice"/>
                <button name="action_return" states="sent" string="Return" type="object" groups="account.group_account_invoice"/>
                <button name="action_take" states="posted" string="Take" type="object" groups="account.group_account_invoice"/>
                <button name="action_cancel" attrs="{'invisible': [('state', '=', 'cancelled')]}" type="object" string="Cancel" groups="account.group_account_invoice"/>
                <field name="state" widget="statusbar"/>
                </header>
                <sheet>
                    <div class="oe_title">
                        <h1>
                            <field name="name"/>
                        </h1>
                    </div>

                    <group>
                      <group>
                            <field name="type"/>
                            <field name="code"/>
                            <field name="tax_rate"/>
                            <field name="amount_untaxed" widget="monetary"/>
                            <field name="amount_tax" widget="monetary"/>
                            <field name="amount_total" widget="monetary"/>
                        </group>
                        <group>
                            <field name="express_code"/>
                            <field name="sent_type"/>
                            <field name="sent_date"/>
                        </group>
                    </group>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="activity_ids" widget="mail_activity"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>
            </form>
        </field>
    </record>

    <record id="view_account_sale_invoice_filter_qm" model="ir.ui.view">
        <field name="name">qm.account.sale.invoice.select</field>
        <field name="model">account.sale.invoice</field>
        <field name="arch" type="xml">
            <search string="Search Invoice">
                <field name="name" string="Invoice Name"/>
                <field name="code" string="Invoice Code"/>
                <field name="express_code" string="Express Reference"/>
                <separator/>
                <filter name="sent" string="Sent" domain="[('state','=','sent')]" />
                <filter name="cancel" string="Cancelled" domain="[('state','=','cancel')]" />
                <separator/>
                <filter string="Invoice Date" name="posted_date" date="posted_date"/>
                <filter string="Sent Date" name="sent_date" date="sent_date"/>
            </search>
        </field>
    </record>


    <record id="action_account_sale_invoice_qm" model="ir.actions.act_window">
        <field name="name">Invoices</field>
        <field name="res_model">account.sale.invoice</field>
        <field name="view_mode">tree,kanban,form</field>
        <field name="view_id" ref="view_account_sale_invoice_tree_qm"/>
        <field name="search_view_id" ref="view_account_sale_invoice_filter_qm"/>
        <field name="help" type="html">
          <p class="o_view_nocontent_smiling_face">
            Create a customer invoice
          </p><p>
            Create invoices
          </p>
        </field>
    </record>


    <menuitem
    id="menu_action_account_sale_invoice_qm"
    action="action_account_sale_invoice_qm"
    parent="account.menu_finance_receivables"
    sequence="1"/>


    <record id="view_account_purchase_invoice_tree_qm" model="ir.ui.view">
      <field name="name">qm.account.purchase.invoice.tree</field>
      <field name="model">account.purchase.invoice</field>
      <field name="arch" type="xml">
        <tree decoration-muted="state in ['cancelled', 'reject']" decoration-success="state=='verified'">
          <field name="name"/>
          <field name="code" optional="show"/>
          <field name="type" optional="show"/>
          <field name="partner_id"/>
          <field name="amount_untaxed" optional="hide"/>
          <field name="amount_tax" optional="show"/>
          <field name="amount_total" optional="show"/>
          <field name="create_date" optional="show"/>
          <field name="posted_date" optional="show"/>
          <field name="state" optional="show"/>
        </tree>
      </field>
    </record>


    <record id="view_account_purchase_invoice_form_qm" model="ir.ui.view">
      <field name="name">qm.account.purchase.invoice.form</field>
      <field name="model">account.purchase.invoice</field>
      <field name="arch" type="xml">
        <form string="Invoices">
          <header>
            <button name="post" states="draft" type="object" class="btn-primary" string="Post"/>
            <button name="action_draft" class="btn btn-secondary" attrs="{'invisible': [('state', '=', 'draft')]}" string="Reset To Draft" type="object"/>
            <button name="action_cancel" attrs="{'invisible': [('state', '=', 'cancelled')]}" type="object" string="Cancel"/>
            <button name="action_reject" states="posted,approved" type="object" string="Reject"/>
            <button name="action_approve" states="posted" type="object" string="Approve"/>
            <button name="action_verify" states="approved" type="object" string="Verify"/>
            <field name="state" widget="statusbar" statusbar_visible="draft,posted,approved,verified,cancelled,reject"/>
          </header>
          <sheet>
            <div class="oe_title">
              <h1>
                <field name="name"/>
              </h1>
            </div>

            <group>
              <group>
                <field name="type"/>
                <field name="code"/>
                <field name="tax_rate"/>
                <field name="amount_untaxed" widget="monetary"/>
                <field name="amount_tax" widget="monetary"/>
                <field name="amount_total" widget="monetary"/>
              </group>

              <group>
                <field name="partner_id"/>
                <field name="purchase_order_ids" widget="many2many_tags"/>
                <field name="posted_by"/>
                <field name="posted_date"/>
                <field name="approved_by"/>
                <field name="approved_date"/>
                <field name="verified_by"/>
                <field name="verified_date"/>
                <field name="reject_by"/>
                <field name="reject_date"/>
                <field name="reject_reason"/>
                <field name="cancel_by"/>
                <field name="cancel_date"/>
              </group>
            </group>

            <notebook>
              <page string="Lines">
                <field name="line_ids" mode="tree">
                  <tree editable="false" create="false"
                        string="Lines">
                    <field name="product_id"/>
                    <field name="product_qty"/>
                    <field name="product_uom"/>
                    <field name="price_unit"/>
                    <field name="taxes_id" widget="many2many_tags" optional="show"/>
                    <field name="price_subtotal" optional="show"/>
                  </tree>
                </field>
              </page>
            </notebook>
          </sheet>
          <div class="oe_chatter">
            <field name="message_follower_ids" widget="mail_followers"/>
            <field name="activity_ids" widget="mail_activity"/>
            <field name="message_ids" widget="mail_thread"/>
          </div>
        </form>
      </field>
    </record>


    <record id="view_account_purchase_invoice_line_form" model="ir.ui.view">
      <field name="name">qm.account.purchase.invoice.line.form</field>
      <field name="model">account.purchase.invoice.line</field>
      <field name="arch" type="xml">
        <form create="false">
          <sheet>
            <group>
              <group>
                <field name="purchase_line_id"/>
                <field name="product_id"/>
                <field name="product_qty"/>
                <field name="product_uom"/>
                <field name="price_unit"/>
                <field name="taxes_id" widget="many2many_tags"/>
              </group>
              <group>
                <field name="partner_id"/>
                <field name="price_subtotal"/>
                <field name="price_total"/>
                <field name="price_tax"/>
              </group>
            </group>
          </sheet>
        </form>
      </field>
    </record>


    <record id="view_account_purchase_invoice_filter_qm" model="ir.ui.view">
      <field name="name">qm.account.purchase.invoice.select</field>
      <field name="model">account.purchase.invoice</field>
      <field name="arch" type="xml">
        <search string="Search Invoice">
          <field name="name"/>
          <field name="code"/>
          <separator/>
          <filter name="posted" string="Posted" domain="[('state','=','posted')]"/>
          <filter name="approved" string="Approved" domain="[('state','=','approved')]"/>
          <filter name="verified" string="Verified" domain="[('state','=','verified')]"/>
          <filter name="reject" string="Reject" domain="[('state','=','reject')]"/>
          <filter name="cancelled" string="Cancelled" domain="[('state','=','cancelled')]"/>
          <separator/>
          <filter string="Create Date" name="create_date" date="create_date"/>
          <filter string="Posted Date" name="posted_date" date="posted_date"/>
        </search>
      </field>
    </record>

    <record id="action_account_purchase_invoice_qm" model="ir.actions.act_window">
      <field name="name">Purchase Invoice</field>
      <field name="res_model">account.purchase.invoice</field>
      <field name="view_mode">tree,kanban,form</field>
      <field name="view_id" ref="view_account_purchase_invoice_tree_qm"/>
      <field name="search_view_id" ref="view_account_purchase_invoice_filter_qm"/>
      <field name="help" type="html">
          <p class="o_view_nocontent_smiling_face">
            Create a partner invoice
          </p><p>
            Create invoices
          </p>        
      </field>
    </record>

    <menuitem
        id="menu_action_account_purchase_invoice_qm"
        action="action_account_purchase_invoice_qm"
        parent="account.menu_finance_payables"
        sequence="3"/>

    <record id="action_create_purchase_invoice_from_purchase_line_list" model="ir.actions.server">
      <field name="name">Create Purchase Invoice</field>
      <field name="model_id" ref="qm.model_account_purchase_invoice"/>
      <field name="binding_model_id" ref="purchase.model_purchase_order_line"/>
      <field name="binding_view_types">list</field>
      <field name="state">code</field>
      <field name="code">
        action = model.action_create_purchase_invoice()
      </field>
    </record>

</odoo>
